(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{1326:function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return c}));var n=a(1),s=a.n(n),r=a(28),i=a.n(r),o=a(37);const c={APIS:"/apis",SINGLE_API:"/apis/{apiId}",API_SWAGGER:"/apis/{apiId}/swagger",API_WSDL:"/apis/{apiId}/wsdl",API_GW_CONFIG:"/apis/{apiId}/gateway-config",API_THUMBNAIL:"/apis/{apiId}/thumbnail",API_COPY:"/apis/copy-api",API_LC_HISTORY:"/apis/{apiId}/lifecycle-history",API_CHANGE_LC:"/apis/change-lifecycle",API_LC:"/apis/{apiId}/lifecycle",API_LC_PENDING_TASK:"/apis/{apiId}/lifecycle/lifecycle-pending-task",API_DEF:"/apis/import-definition",API_VALIDATE_DEF:"/apis/validate-definition",API_DOCS:"/apis/{apiId}/documents",API_DOC:"'/apis/{apiId}/documents/{documentId}'",API_DOC_CONTENT:"'/apis/{apiId}/documents/{documentId}/content'",APPLICATIONS:"/applications",SINGLE_APPLICATION:"/applications/{applicationId}",APPLICATION_GENERATE_KEYS:"/applications/{applicationId}/generate-keys",APPLICATION_GENERATE_KEY_TYPE:"/applications/{applicationId}/keys/{keyType}",EXPORT_APIS:"/export/apis",IMPORT_APIS:"/import/apis",SUBSCRIPTION:"/subscriptions",SINGLE_SUBSCRIPTION:"/subscriptions/{subscriptionId}",SUBSCRIPTIONS:"/subscriptions",BLOCK_SUBSCRIPTION:"/subscriptions/block-subscription:",UNBLOCK_SUBSCRIPTION:"/subscriptions/unblock-subscription",POLICIES:"'/policies/{tierLevel}'",POLICY:"'/policies/{tierLevel}/{tierName}'",ENDPOINTS:"/endpoints",ENDPOINT:"/endpoints/{endpointId}",LABLES:"/labels",WORKFLOW:"/workflows/{workflowReferenceId}",SERVICE_DISCOVERY:"/external-resources/services"},l={POST:"post",PUT:"put",GET:"get",DELETE:"delete"};class p extends s.a.Component{constructor(e){super(e),this.state={}}componentDidMount(){const{resourcePath:e,resourceMethod:t}=this.props,a=o.a.hasScopes(e,t);a&&a.then(e=>{this.setState({haveScope:e})})}render(){const{children:e}=this.props;return this.state.haveScope&&e||null}}p.propTypes={children:i.a.node.isRequired,resourcePath:i.a.string.isRequired,resourceMethod:i.a.string.isRequired}},1487:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(130),s=a(132),r=a(7);class i extends s.a{constructor(){super(),this.client=(new n.a).getAPIClient(r.a.getEnvironment().label).client}getSubscriptions(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25;return this.client.then(n=>n.apis.Subscriptions.get_subscriptions({apiId:e,applicationId:t,limit:a}))}getSubscription(e){return this.client.then(t=>t.apis.Subscriptions.get_subscriptions__subscriptionId_({subscriptionId:e}))}getMonetizationInvoice(e){return this.client.then(t=>t.apis["API Monetization"].get_subscriptions__subscriptionId__usage({subscriptionId:e}))}deleteSubscription(e){return this.client.then(t=>t.apis.Subscriptions.delete_subscriptions__subscriptionId_({subscriptionId:e}))}}},1639:function(e,t,a){"use strict";var n=a(1),s=a.n(n),r=a(28),i=a.n(r),o=a(1267),c=a(1714),l=a(1645),p=a(1666),d=a(1856),u=a(1764),m=a(1763),y=a(1707),g=a(230),h=a(1324),E=a(1649),k=a(1287),f=a(1669),b=a(1658),S=a(1745),A=a(1656);function T(e){const{classes:t,consumerKey:a,consumerSecret:n,intl:r,onChange:i,isUserOwner:o}=e;function c(e){i&&i(e)}return s.a.createElement("div",null,s.a.createElement(S.a,{container:!0,spacing:3,direction:"column"},s.a.createElement(S.a,{item:!0,xs:6},s.a.createElement(A.a,{id:"provided-consumer-key",name:"providedConsumerKey",className:t.textField,label:r.formatMessage({defaultMessage:"Consumer Key",id:"Shared.AppsAndKeys.ProvideOAuthKeys.consumer.key"}),value:a,onChange:e=>c(e),margin:"normal",fullWidth:!0,disabled:!o,variant:"outlined"}),s.a.createElement(b.a,null,s.a.createElement(f.a,{id:"consumer-key-helper-text"},s.a.createElement(g.a,{id:"Shared.AppsAndKeys.ProvideOAuthKeys.consumer.key.title",defaultMessage:"Consumer Key of the OAuth application"})))),s.a.createElement(S.a,{item:!0,xs:6},s.a.createElement(A.a,{id:"provided-consumer-secret",name:"providedConsumerSecret",label:r.formatMessage({defaultMessage:"Consumer Secret",id:"Shared.AppsAndKeys.ProvideOAuthKeys.consumer.secret"}),className:t.textField,value:n,onChange:e=>c(e),margin:"normal",fullWidth:!0,disabled:!o,variant:"outlined"}),s.a.createElement(b.a,null,s.a.createElement(f.a,{id:"consumer-secret-helper-text"},s.a.createElement(g.a,{id:"Shared.AppsAndKeys.ProvideOAuthKeys.consumer.secret.of.application",defaultMessage:"Consumer Secret of the OAuth application"}))))))}T.propTypes={classes:i.a.shape({}).isRequired,intl:i.a.shape({}).isRequired,onChange:i.a.func.isRequired,consumerKey:i.a.string,consumerSecret:i.a.string,isUserOwner:i.a.string},T.defaultProps={consumerKey:"",consumerSecret:"",isUserOwner:!1};var C=Object(g.e)(Object(o.a)(e=>({textField:{marginTop:0}}))(T)),O=a(1306),v=a(37),K=a(169),I=a(304),P=a(20),w=a.n(P);function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function M(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var N=Object(g.e)(Object(o.a)(e=>({FormControl:{paddingTop:e.spacing(2),paddingBottom:e.spacing(2),paddingLeft:0,width:"100%"},FormControlOdd:{padding:e.spacing(2),width:"100%"},button:{marginLeft:e.spacing(1)},quotaHelp:{position:"relative"},checkboxWrapper:{display:"flex"},checkboxWrapperColumn:{display:"flex",flexDirection:"row"},group:{flexDirection:"row"},removeHelperPadding:{"& p":{margin:"8px 0px"}}}))(e=>{const[t,a]=Object(n.useState)(!1),[r,i]=Object(n.useState)(!1),o=(t,n)=>{const{keyRequest:s,updateKeyRequest:r,setGenerateEnabled:o}=e,c=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){M(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},s),{target:l}=n;switch(t){case"organizationId":(e=>{const t=w.a.openbanking.orgIdRegex,a=new RegExp("^PSD[A-Z]{2}-[A-Z]{2,8}-[[a-zA-Z0-9]*$"),n=new RegExp(w.a.openbanking.orgIdRegex);let s;return s=void 0!==w.a.openbanking.maxAllowedInputLength?w.a.openbanking.maxAllowedInputLength:20,void 0!==t&&s>=e.length?null==e||!n.test(e):null==e||!a.test(e)})(l.value)?(a(!0),o(!1)):(a(!1),o(!0)),c.organizationId=l.value;break;case"certificate":y(l.value)?(i(!0),o(!1)):(i(!1),o(!0)),c.spCertificate=l.value}r(c)},{classes:c,isOrgIdEnabled:p,isRegulatoryApp:d,keys:u,hasKeysGenerated:m}=e,y=e=>{if(null==e)return!0;try{return decodeURIComponent(escape(e)),!1}catch(e){return!0}};return s.a.createElement("div",null,s.a.createElement(S.a,{item:!0,xs:10,md:5},d?s.a.createElement(A.a,{classes:{root:c.removeHelperPadding},fullWidth:!0,id:"certificate",label:s.a.createElement(g.a,{defaultMessage:"Application Certificate",id:"Shared.AppsAndKeys.OBConfiguration.certification.content.label"}),multiline:!0,rows:"10",defaultValue:u?atob(JSON.parse(u).spCert.trim()):"",name:"certificate",onChange:e=>o("certificate",e),helperText:r?s.a.createElement(l.a,{variant:"caption"},s.a.createElement(g.a,{defaultMessage:'Make sure to remove the " -----BEGIN CERTIFICATE-----" and "-----END CERTIFICATE-----" from the certificate content',id:"Shared.AppsAndKeys.OBConfiguration. certification.content.helper.error"})):s.a.createElement(l.a,{variant:"caption"},s.a.createElement(g.a,{defaultMessage:'The application certificate in PEM format<br>NOTE: Make sure to remove the \\"-----BEGIN CERTIFICATE-----\\" and \\"-----END CERTIFICATE-----\\" from the certificate content',id:"Shared.AppsAndKeys.OBConfiguration.certification.content.helper"})),margin:"normal",variant:"outlined",error:r,inputProps:{disabled:m}}):null),s.a.createElement(S.a,{item:!0,xs:10,md:5},d&&p?s.a.createElement(A.a,{classes:{root:c.removeHelperPadding},fullWidth:!0,id:"orgId",label:s.a.createElement(g.a,{defaultMessage:"Organization ID",id:"Shared.AppsAndKeys.OBConfiguration.organization.id.label"}),defaultValue:u?JSON.parse(u).orgId.trim():"",name:"orgId",onChange:e=>o("organizationId",e),helperText:t?s.a.createElement(l.a,{variant:"caption"},s.a.createElement(g.a,{defaultMessage:"Organization identifier cannot be empty or invalid",id:"Shared.AppsAndKeys.OBConfiguration.org.id.content.helper.error"})):s.a.createElement(l.a,{variant:"caption"},s.a.createElement(g.a,{defaultMessage:"Organization Identifier as provided in the eIDAS certificate. E.g. PSDUK-NCA-OrganizationID",id:"Shared.AppsAndKeys.OBConfiguration.org.id.content.helper"})),margin:"normal",variant:"outlined",error:t,inputProps:{disabled:m}}):null))})),x=a(1778),D=a(1678),_=a(1659),j=a(1644),G=a(1368),U=a.n(G),W=a(1676),L=a(1756),q=a(1757),z=a(1758),B=a(1759),F=a(1760),V=a(1314),J=a(1780),H=a(1567),Y=a(1781),$=a(1523),X=a(1568),Z=a.n(X);const Q=Object($.a)(e=>({code:{padding:e.spacing(1),marginBottom:e.spacing(2),background:e.palette.grey[200],color:"#da2316",flex:1},command:{color:"#2b62b0"},encodeVisible:{cursor:"pointer",textDecoration:"underline"},contentWrapper:{display:"flex"}}));function ee(e){const t=Q(),{keys:{consumerKey:a,consumerSecret:r},intl:i}=e,o=window.btoa(a+":"+r),{settings:{apiGatewayEndpoint:c}}=Object(n.useContext)(K.c),[p,d]=Object(n.useState)(!1),[u,m]=Object(n.useState)(!1),y=()=>{m(!0);setTimeout((function(){m(!1)}),4e3)},h=()=>{d(!p)},E=`${c?c.split(",")[0]:"https://localhost:8243"}/token`;return s.a.createElement(s.a.Fragment,null,s.a.createElement(l.a,null,s.a.createElement(g.a,{id:"Shared.AppsAndKeys.ViewCurl.help",defaultMessage:"The following cURL command shows how to generate an access token using the Password Grant type."})),s.a.createElement("div",{className:t.contentWrapper},s.a.createElement("div",{className:t.code},s.a.createElement("div",null,s.a.createElement("span",{className:t.command},"curl -k -X POST ")," ",E,s.a.createElement("span",{className:t.command}," -d ")," ",'"grant_type=password&username=Username&password=Password"'),s.a.createElement("div",null,s.a.createElement("span",{className:t.command}," -H "),'"Authorization: Basic',s.a.createElement("a",{onClick:h,className:t.encodeVisible},p?" "+o:" Base64(consumer-key:consumer-secret)"),'"')),s.a.createElement("div",null,s.a.createElement(W.a,{title:u?i.formatMessage({defaultMessage:"Copied",id:"Shared.AppsAndKeys.ViewCurl.copied"}):i.formatMessage({defaultMessage:"Copy to clipboard",id:"Shared.AppsAndKeys.ViewCurl.copy.to.clipboard"}),placement:"right"},s.a.createElement(U.a,{text:`curl -k -X POST ${E} -d `+'"grant_type=password&username=Username&password=Password" -H '+`"Authorization: Basic ${o}"`,onCopy:y},s.a.createElement(Z.a,{color:"secondary"}))))),s.a.createElement(l.a,null,s.a.createElement(g.a,{id:"Shared.AppsAndKeys.ViewCurl.help.in.a.similar",defaultMessage:"In a similar manner, you can generate an access token using the\n                    Client Credentials grant type with the following cURL command."})),s.a.createElement("div",{className:t.contentWrapper},s.a.createElement("div",{className:t.code},s.a.createElement("div",null,s.a.createElement("span",{className:t.command},"curl -k -X POST ")," ",E,s.a.createElement("span",{className:t.command}," -d ")," ",'"grant_type=client_credentials"'),s.a.createElement("div",null,s.a.createElement("span",{className:t.command}," -H "),'"Authorization: Basic',s.a.createElement("a",{onClick:h,className:t.encodeVisible},p?" "+o:" Base64(consumer-key:consumer-secret)"),'"')),s.a.createElement("div",null,s.a.createElement(W.a,{title:u?"Copied":"Copy to clipboard",placement:"right"},s.a.createElement(U.a,{text:`curl -k -X POST ${E} -d `+'"grant_type=client_credentials" -H'+`"Authorization: Basic ${o}"`,onCopy:y},s.a.createElement(Z.a,{color:"secondary"}))))))}ee.propTypes={classes:i.a.shape({}).isRequired,keys:i.a.shape({}).isRequired,apis:i.a.shape({}).isRequired};var te=Object(g.e)(ee);function ae(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ne(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(a),!0).forEach((function(t){se(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ae(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function se(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class re extends s.a.Component{constructor(e){super(e),se(this,"updateAccessTokenRequest",e=>{this.setState({accessTokenRequest:e})}),se(this,"onCopy",e=>{this.setState({[e]:!0});const t=this,a=e;setTimeout(()=>{t.setState({[a]:!1})},4e3)}),se(this,"handleShowHidden",e=>{this.setState({[e]:!this.state[e]})}),se(this,"handleMouseDownGeneric",e=>{e.preventDefault()}),se(this,"handleClickOpen",()=>{this.setState({open:!0,showToken:!1})}),se(this,"handleSecretRegenerate",(e,t)=>{this.applicationPromise.then(a=>a.regenerateSecret(e,t)).then(e=>{console.log("consumer secret regenerated successfully "+e),this.setState({open:!0,showSecretGen:!0,secretGenResponse:e})}).catch(e=>{const{status:t}=e;404===t&&this.setState({notFound:!0})})}),se(this,"handleClickOpenCurl",()=>{this.setState({open:!0,showCurl:!0})}),se(this,"handleClose",()=>{this.setState({open:!1,showCurl:!1,isKeyJWT:!1,showSecretGen:!1})}),se(this,"generateAccessToken",()=>{const{accessTokenRequest:e,isUpdating:t}=this.state;this.setState({isUpdating:!0}),this.applicationPromise.then(t=>t.generateToken(e.keyType,e.timeout,e.scopesSelected)).then(e=>{console.log("token generated successfully "+e),this.setState({showToken:!0,tokenResponse:e,token:e.accessToken,tokenScopes:e.tokenScopes,tokenValidityTime:e.validityTime}),this.setState({isUpdating:!1})}).catch(e=>{const{status:t}=e;404===t&&this.setState({notFound:!0}),this.setState({isUpdating:!1})})}),se(this,"viewKeyAndSecret",(e,t)=>{const{classes:a,intl:n,selectedApp:{hashEnabled:r},keyType:i}=this.props,{keyCopied:o,secretCopied:l,showCS:p}=this.state;return s.a.createElement(s.a.Fragment,null,s.a.createElement(S.a,{item:!0,xs:6},s.a.createElement("div",{className:a.copyWrapper},s.a.createElement(A.a,{id:"consumer-key",value:e,margin:"normal",label:s.a.createElement(g.a,{id:"Shared.AppsAndKeys.ViewKeys.consumer.key",defaultMessage:"Consumer Key"}),fullWidth:!0,variant:"outlined",InputProps:{readOnly:!0,endAdornment:s.a.createElement(j.a,{position:"end"},s.a.createElement(W.a,{title:o?n.formatMessage({defaultMessage:"Copied",id:"Shared.AppsAndKeys.ViewKeys.copied"}):n.formatMessage({defaultMessage:"Copy to clipboard",id:"Shared.AppsAndKeys.ViewKeys.copy.to"}),placement:"right",className:a.iconStyle},s.a.createElement(U.a,{text:e,onCopy:()=>this.onCopy("keyCopied")},s.a.createElement(y.a,{color:"secondary"},"description"))))}})),s.a.createElement(b.a,null,s.a.createElement(f.a,{id:"consumer-key-helper-text"},s.a.createElement(g.a,{id:"Shared.AppsAndKeys.ViewKeys.consumer.key.title",defaultMessage:"Consumer Key of the application"})))),s.a.createElement(S.a,{item:!0,xs:6},s.a.createElement("div",{className:a.copyWrapper},r?s.a.createElement(c.a,{variant:"contained",color:"primary",className:a.button,onClick:()=>this.handleSecretRegenerate(e,i),disabled:!isUserOwner},s.a.createElement(g.a,{defaultMessage:"Regenerate Consumer Secret",id:"Shared.AppsAndKeys.ViewKeys.consumer.secret.button.regenerate"})):s.a.createElement(A.a,{id:"consumer-secret",label:s.a.createElement(g.a,{id:"Shared.AppsAndKeys.ViewKeys.consumer.secret",defaultMessage:"Consumer Secret"}),type:p||!t?"text":"password",value:t,margin:"normal",fullWidth:!0,variant:"outlined",InputProps:{readOnly:!0,endAdornment:s.a.createElement(j.a,{position:"end"},s.a.createElement(D.a,{classes:"",onClick:()=>this.handleShowHidden("showCS"),onMouseDown:this.handleMouseDownGeneric},p?s.a.createElement(y.a,null,"visibility_off"):s.a.createElement(y.a,null,"visibility")),s.a.createElement(W.a,{title:l?"Copied":"Copy to clipboard",placement:"right",className:a.iconStyle},s.a.createElement(U.a,{text:t,onCopy:()=>this.onCopy("secretCopied")},s.a.createElement(y.a,{color:"secondary"},"description"))))}})),!r&&s.a.createElement(b.a,null,s.a.createElement(f.a,{id:"consumer-secret-helper-text"},s.a.createElement(g.a,{id:"Shared.AppsAndKeys.ViewKeys.consumer.secret.of.application",defaultMessage:"Consumer Secret of the application"})))))});const{selectedApp:t}=this.props;let a;t&&(a=t.appId||t.value),this.applicationPromise=O.a.get(a),this.state={showCS:!1,open:!1,showToken:!1,showCurl:!1,showSecretGen:!1,accessTokenRequest:{timeout:3600,scopesSelected:[],keyType:""},subscriptionScopes:[],isUpdating:!1}}componentDidMount(){const{accessTokenRequest:e}=this.state,{keyType:t}=this.props;this.applicationPromise.then(a=>{a.getKeys().then(()=>{const n=ne({},e,{keyType:t}),s=a.subscriptionScopes.map(e=>e.key);this.setState({accessTokenRequest:n,subscriptionScopes:s})})}).catch(e=>{const{status:t}=e;404===t&&this.setState({notFound:!0})})}componentDidUpdate(e){const{isKeyJWT:t}=this.props;t&&!e.isKeyJWT&&this.setState({isKeyJWT:!0})}render(){const{notFound:e,showToken:t,showCurl:a,showSecretGen:n,tokenCopied:r,open:i,token:o,tokenScopes:p,tokenValidityTime:d,accessTokenRequest:u,subscriptionScopes:m,isKeyJWT:k,tokenResponse:T,secretGenResponse:C,isUpdating:O}=this.state,{intl:v,keyType:K,classes:I,fullScreen:P,keys:w,selectedApp:{tokenType:R,hashEnabled:M},selectedGrantTypes:N,isUserOwner:x,summary:D,isRegulatoryApp:G}=this.props;if(e)return s.a.createElement(V.a,null);if(!w)return s.a.createElement(h.a,null);const $=w.get(K),X=$&&$.consumerKey,Z=$&&$.consumerSecret;let Q,ee,ae,se;o?(Q=o,ee=p,ae=d):w.get(K)&&w.get(K).token&&(({accessToken:Q}=w.get(K).token),ee=w.get(K).token.tokenScopes,ae=w.get(K).token.validityTime,se=w.get(K).token);let re="Undefined";return re=a?"Get CURL to Generate Access Token":n?"Generate Consumer Secret":"Generate Access Token",X?D?s.a.createElement(S.a,{container:!0,spacing:3,className:I.gridWrapper},this.viewKeyAndSecret(X,Z)):X&&s.a.createElement("div",{className:I.inputWrapper},s.a.createElement(S.a,{container:!0,spacing:3,className:I.gridWrapper},this.viewKeyAndSecret(X,Z),Q&&"JWT"!==R&&!M&&s.a.createElement(S.a,{item:!0,xs:6},s.a.createElement(_.a,{htmlFor:"adornment-amount"},s.a.createElement(g.a,{id:"Shared.AppsAndKeys.ViewKeys.access.token",defaultMessage:"Access Token"})),s.a.createElement("div",{className:I.copyWrapper},s.a.createElement(A.a,{id:"access-token",value:Q,margin:"normal",variant:"outlined",fullWidth:!0,InputProps:{readOnly:!0,endAdornment:s.a.createElement(j.a,{position:"end"},s.a.createElement(W.a,{title:r?"Copied":"Copy to clipboard",placement:"right"},s.a.createElement(U.a,{text:Q,onCopy:()=>this.onCopy("tokenCopied")},s.a.createElement(y.a,{color:"secondary"},"description"))))}})),s.a.createElement(b.a,null,s.a.createElement(f.a,{id:"access-token-helper-text"},`Above token has a validity period of ${ae} seconds.\n                                            And the token has (${ee.join(", ")}) scopes.`))),s.a.createElement(S.a,{item:!0,xs:12},s.a.createElement(L.a,{fullScreen:P,open:(i||k)&&N.includes("client_credentials"),onClose:this.handleClose,"aria-labelledby":"responsive-dialog-title",className:I.dialogWrapper},s.a.createElement(F.a,{id:"responsive-dialog-title"},re),s.a.createElement(z.a,null,!a&&!k&&!n&&s.a.createElement(B.a,null,!t&&s.a.createElement(J.a,{updateAccessTokenRequest:this.updateAccessTokenRequest,accessTokenRequest:u,subscriptionScopes:m}),t&&s.a.createElement(H.a,{token:ne({},T,{isOauth:!0})})),a&&s.a.createElement(B.a,null,s.a.createElement(te,{keys:{consumerKey:X,consumerSecret:Z}})),n&&s.a.createElement(B.a,null,s.a.createElement(Y.a,{secret:ne({},C)})),k&&se&&M&&s.a.createElement(B.a,null,s.a.createElement(H.a,{token:ne({},se,{isOauth:!0}),consumerSecret:Z})),k&&se&&!M&&s.a.createElement(B.a,null,s.a.createElement(H.a,{token:ne({},se,{isOauth:!0})}))),s.a.createElement(q.a,null,O&&s.a.createElement(E.a,{size:24}),!t&&!a&&!k&&!n&&s.a.createElement(c.a,{onClick:this.generateAccessToken,color:"primary",disabled:O},s.a.createElement(g.a,{id:"Shared.AppsAndKeys.ViewKeys.consumer.generate.btn",defaultMessage:"Generate"})),s.a.createElement(c.a,{onClick:this.handleClose,color:"primary",autoFocus:!0},s.a.createElement(g.a,{id:"Shared.AppsAndKeys.ViewKeys.consumer.close.btn",defaultMessage:"Close"})))),!M&&!G&&s.a.createElement("div",{className:I.tokenSection},s.a.createElement(c.a,{variant:"outlined",size:"small",color:"primary",className:I.margin,onClick:this.handleClickOpen,disabled:!N.includes("client_credentials")},s.a.createElement(g.a,{id:"Shared.AppsAndKeys.ViewKeys.generate.access.token",defaultMessage:"Generate Access Token"})),s.a.createElement(c.a,{variant:"outlined",size:"small",color:"primary",className:I.margin,onClick:this.handleClickOpenCurl},s.a.createElement(g.a,{id:"Shared.AppsAndKeys.ViewKeys.curl.to.generate",defaultMessage:"CURL to Generate Access Token"}))),!N.includes("client_credentials")&&!M&&s.a.createElement(l.a,{variant:"caption",gutterBottom:!0},s.a.createElement(g.a,{id:"Shared.AppsAndKeys.ViewKeys.client.enable.client.credentials",defaultMessage:"Enable Client Credentials grant type to generate test access tokens"}))))):s.a.createElement(l.a,{variant:"caption",gutterBottom:!0},"PRODUCTION"===K?"Production ":"Sandbox ",s.a.createElement(g.a,{id:"Shared.AppsAndKeys.ViewKeys.key.secret.title",defaultMessage:"Key and Secret is not generated for this application"}))}}re.defaultProps={fullScreen:!1,summary:!1},re.propTypes={classes:i.a.shape({}).isRequired,fullScreen:i.a.bool,isKeyJWT:i.a.bool.isRequired,isUserOwner:i.a.bool.isRequired,summary:i.a.bool};var ie=Object(g.e)(Object(o.a)(e=>({button:{margin:e.spacing(3),color:e.palette.getContrastText(e.palette.background.default),display:"flex",alignItems:"center",fontSize:"11px",cursor:"pointer","& span":{paddingLeft:6,display:"inline-block"}},inputWrapper:{display:"flex",flexDirection:"row",alignItems:"center","& span, & h5, & label, & td, & li, & div, & input":{color:e.palette.getContrastText(e.palette.background.paper)}},copyWrapper:{display:"flex",flexDirection:"row",alignItems:"center"},gridWrapper:{paddingTop:e.spacing(2)},iconStyle:{cursor:"grab"},tokenSection:{marginTop:e.spacing(2),marginBottom:e.spacing(.5)},margin:{marginRight:e.spacing(2)},dialogWrapper:{"& label,& h5, & label, & td, & li, & input, & h2, & p.MuiTypography-root,& p.MuiFormHelperText-root":{color:e.palette.getContrastText(e.palette.background.paper)}}}))(re));var oe=Object(g.e)(Object(o.a)(e=>({root:{padding:e.spacing(3)}}))(e=>{const{classes:t,keyState:a,states:n,intl:r}=e;let i=r.formatMessage({defaultMessage:"A request to register this application has been sent and is pending approval.",id:"Shared.AppsAndKeys.WaitingForApproval.msg.ok"});return a===n.REJECTED&&(i=r.formatMessage({defaultMessage:"This application has been rejected from generating keys",id:"Shared.AppsAndKeys.WaitingForApproval.msg.reject"})),s.a.createElement("div",{className:t.root},i)})),ce=a(1326);const le=Object($.a)(e=>({root:{padding:e.spacing(3,2)},noKeysRoot:{backgroundImage:`url(${P.app.context+e.custom.overviewPage.keysBackground})`,height:"100%",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover",minHeight:192,display:"flex",alignItems:"center"}}));function pe(e){const t=le(),{keys:a,keyStates:n,key:r,selectedApp:i,keyType:o,isKeyJWT:c,isUserOwner:p}=e;if(a.size>0&&r&&"APPROVED"===r.keyState&&!r.consumerKey)return s.a.createElement("div",{className:t.emptyBox},s.a.createElement(l.a,{variant:"h5",component:"h3"},"Error"),s.a.createElement(l.a,{variant:"body2"},s.a.createElement(g.a,{id:"Shared.AppsAndKeys.TokenManagerSummary",defaultMessage:"Error! You have partially-created keys. Use `Clean Up` option."})));if(r&&(r.keyState===n.CREATED||r.keyState===n.REJECTED))return s.a.createElement("div",{className:t.emptyBox},s.a.createElement(l.a,{variant:"body2"},s.a.createElement(oe,{keyState:r.keyState,states:n})));const d=r?r.supportedGrantTypes:[];return s.a.createElement(ie,{selectedApp:i,keyType:o,keys:a,isKeyJWT:c,selectedGrantTypes:d,isUserOwner:p,summary:!0})}var de=a(170);function ue(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function me(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(a),!0).forEach((function(t){ye(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ue(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ye(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class ge extends s.a.Component{constructor(e){super(e),ye(this,"setGenerateEnabled",e=>{this.setState({generateEnabled:e})}),ye(this,"getserverSupportedGrantTypes",()=>{(new I.a).getSettings().then(e=>{const{keyRequest:t}=this.state,a=me({},t),{selectedApp:n}=this.props;n.isRegulatory?(a.serverSupportedGrantTypes=Object.keys(P.openbanking.grantTypes).filter(t=>e.obj.grantTypes.includes(t)),a.supportedGrantTypes=Object.keys(P.openbanking.grantTypes).filter(t=>e.obj.grantTypes.includes(t))):(a.serverSupportedGrantTypes=e.obj.grantTypes,a.supportedGrantTypes=e.obj.grantTypes.filter(e=>"authorization_code"!==e&&"implicit"!==e)),this.setState({keyRequest:a})}).catch(e=>{const{status:t}=e;404===t&&this.setState({notFound:!0})})}),ye(this,"loadApplication",()=>{this.getserverSupportedGrantTypes(),this.appId&&this.application.then(e=>e.getKeys()).then(e=>{const{keyType:t}=this.props,{keyRequest:a}=this.state;if(e.size>0&&e.get(t)){const{callbackUrl:n,supportedGrantTypes:s}=e.get(t),r=me({},a,{callbackUrl:n,supportedGrantTypes:s});this.setState({keys:e,keyRequest:r})}else this.setState({keys:e})}).catch(e=>{404===e.status&&this.setState({notFound:!0})})});const{selectedApp:t,keyType:a}=this.props;this.state={isLoading:!1,keys:null,isKeyJWT:!1,keyRequest:{keyType:a,serverSupportedGrantTypes:[],supportedGrantTypes:[],callbackUrl:"",validityTime:3600},providedConsumerKey:"",providedConsumerSecret:"",generateEnabled:!0},this.keyStates={COMPLETED:"COMPLETED",APPROVED:"APPROVED",CREATED:"CREATED",REJECTED:"REJECTED"},t&&(this.isRegulatoryApp=t.isRegulatory,this.appId=t.appId||t.value,this.application=O.a.get(this.appId)),this.updateKeyRequest=this.updateKeyRequest.bind(this),this.generateKeys=this.generateKeys.bind(this),this.updateKeys=this.updateKeys.bind(this),this.cleanUpKeys=this.cleanUpKeys.bind(this),this.handleOnChangeProvidedOAuth=this.handleOnChangeProvidedOAuth.bind(this),this.provideOAuthKeySecret=this.provideOAuthKeySecret.bind(this)}componentDidMount(){this.loadApplication()}updateKeyRequest(e){this.setState({keyRequest:e})}generateKeys(){const{keyRequest:e,keys:t}=this.state;this.setState({isLoading:!0});const{keyType:a,updateSubscriptionData:n,selectedApp:{tokenType:s,hashEnabled:r},intl:i}=this.props;this.application.then(t=>{let n=null!=e.organizationId?e.organizationId:null,s=null!=e.spCertificate?btoa(e.spCertificate.trim()):null;return t.generateKeys(a,e.supportedGrantTypes,e.callbackUrl,e.validityTime,'{ "orgId": "'+n+'", "spCert": "'+s+'" }')}).then(e=>{n&&n();const o=new Map([...t]),c="JWT"===s||r;o.set(a,e),this.setState({keys:o,isKeyJWT:c}),k.a.info(i.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.generate.success",defaultMessage:"Application keys generated successfully"}))}).catch(e=>{const{status:t}=e;404===t&&this.setState({notFound:!0}),k.a.error(i.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.generate.error",defaultMessage:"Error occurred when generating application keys"}))}).finally(()=>this.setState({isLoading:!1}))}updateKeys(){this.setState({isLoading:!0});const{keys:e,keyRequest:t}=this.state,{keyType:a,intl:n}=this.props,s=e.get(a);this.application.then(e=>e.updateKeys(s.tokenType,a,t.supportedGrantTypes,t.callbackUrl,s.consumerKey,s.consumerSecret)).then(e=>{this.setState({keys:e.keys}),k.a.info(n.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.update.success",defaultMessage:"Application keys updated successfully"}))}).catch(e=>{const{status:t}=e;404===t&&this.setState({notFound:!0}),k.a.error(n.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.update.error",defaultMessage:"Error occurred when updating application keys"}))}).finally(()=>this.setState({isLoading:!1}))}cleanUpKeys(){const{keyType:e,intl:t}=this.props;this.application.then(t=>t.cleanUpKeys(e)).then(()=>{this.loadApplication(),k.a.info(t.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.cleanup.success",defaultMessage:"Application keys cleaned successfully"}))}).catch(e=>{const{status:a}=e;404===a&&this.setState({notFound:!0}),k.a.error(t.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.cleanup.error",defaultMessage:"Error occurred while cleaning up application keys"}))})}handleOnChangeProvidedOAuth(e){this.setState({[e.target.name]:e.target.value})}provideOAuthKeySecret(){const{providedConsumerKey:e,providedConsumerSecret:t}=this.state,{keyType:a,intl:n}=this.props;this.application.then(n=>n.provideKeys(a,e,t)).then(()=>{this.setState({providedConsumerKey:"",providedConsumerSecret:""}),k.a.info(n.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.provide.success",defaultMessage:"Application keys provided successfully"}))}).catch(e=>{const{status:t}=e;404===t&&this.setState({notFound:!0}),k.a.error(n.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.provide.error",defaultMessage:"Error occurred when providing application keys"}))})}getOrgIDEnabled(){return"uk"!==P.openbanking.spec.toLowerCase()&&"berlin"===P.openbanking.spec.toLowerCase()}render(){const{classes:e,selectedApp:t,keyType:a,summary:n}=this.props,{keys:r,keyRequest:i,isLoading:o,isKeyJWT:k,providedConsumerKey:f,providedConsumerSecret:b,generateEnabled:S}=this.state;if(!r)return s.a.createElement(h.a,null);const A=v.a.getUser().name;let T=!1;t.owner&&A.toLowerCase()===t.owner.toLowerCase()&&(T=!0);const O=r.get(a);if(O&&O.token&&(i.validityTime=O.token.validityTime),n)return r?s.a.createElement(pe,{keys:r,key:O,keyStates:this.keyStates,selectedApp:t,keyType:a,isKeyJWT:k,isUserOwner:T}):s.a.createElement(de.a,null);if(r.size>0&&O&&"APPROVED"===O.keyState&&!O.consumerKey)return s.a.createElement(s.a.Fragment,null,s.a.createElement(l.a,{className:e.cleanUpInfoText,variant:"subtitle1"},s.a.createElement(g.a,{id:"Shared.AppsAndKeys.TokenManager.cleanup.text",defaultMessage:"Error! You have partially-created keys. Please click `Clean Up` button and try again."})),s.a.createElement(c.a,{variant:"contained",color:"primary",className:e.cleanUpButton,onClick:this.cleanUpKeys},s.a.createElement(g.a,{defaultMessage:"Clean up",id:"Shared.AppsAndKeys.TokenManager.cleanup"})));if(O&&(O.keyState===this.keyStates.CREATED||O.keyState===this.keyStates.REJECTED))return s.a.createElement(oe,{keyState:O.keyState,states:this.keyStates});const K=O?O.supportedGrantTypes:[],I=this.context,{mapExistingAuthApps:P}=I.settings,w=this.getOrgIDEnabled(),R=this.isRegulatoryApp;return s.a.createElement("div",{className:e.root},s.a.createElement(l.a,{variant:"h5"},"PRODUCTION"===a?"Production ":"Sandbox ",s.a.createElement(g.a,{defaultMessage:"Key and Secret",id:"Shared.AppsAndKeys.TokenManager.key.and.secret"})),s.a.createElement(ie,{selectedApp:t,keyType:a,keys:r,isKeyJWT:k,selectedGrantTypes:K,isUserOwner:T,isRegulatoryApp:R}),s.a.createElement(p.a,{className:e.paper},s.a.createElement(d.a,{defaultExpanded:!0},s.a.createElement(u.a,{expandIcon:s.a.createElement(y.a,null,"expand_more")},s.a.createElement(l.a,{className:e.heading,variant:"subtitle1"},r.size>0&&r.get(a)?s.a.createElement(g.a,{defaultMessage:"Key Configurations",id:"Shared.AppsAndKeys.TokenManager.update.configuration"}):s.a.createElement(g.a,{defaultMessage:"Key Configuration",id:"Shared.AppsAndKeys.TokenManager.key.configuration"}))),s.a.createElement(m.a,{className:e.keyConfigWrapper},s.a.createElement(x.a,{keys:r,selectedApp:t,keyType:a,updateKeyRequest:this.updateKeyRequest,keyRequest:i,isUserOwner:T,isKeysAvailable:r.size>0&&r.get(a),setGenerateEnabled:this.setGenerateEnabled,isRegulatoryApp:R})),s.a.createElement(m.a,{className:e.keyConfigWrapper},s.a.createElement(N,{selectedApp:t,keyType:a,updateKeyRequest:this.updateKeyRequest,keyRequest:i,isOrgIdEnabled:w,setGenerateEnabled:this.setGenerateEnabled,isRegulatoryApp:R,keys:r.size>0&&r.get(a)?r.get(a).additionalProperties:null,hasKeysGenerated:r.size>0&&r.get(a)}))),s.a.createElement("div",{className:e.generateWrapper},s.a.createElement(ce.a,{resourcePath:ce.c.APPLICATION_GENERATE_KEYS,resourceMethod:ce.b.POST},T?s.a.createElement(c.a,{variant:"contained",color:"primary",className:e.button,onClick:r.size>0&&r.get(a)?this.updateKeys:this.generateKeys,disabled:!S||o},r.size>0&&r.get(a)?"Update":"Generate Keys",o&&s.a.createElement(E.a,{size:20})):s.a.createElement(s.a.Fragment,null,s.a.createElement(c.a,{variant:"contained",color:"primary",className:e.button,onClick:r.size>0&&r.get(a)?this.updateKeys:this.generateKeys,disabled:!T||o},r.size>0&&r.get(a)?"Update keys":"Generate Keys",o&&s.a.createElement(E.a,{size:20})),s.a.createElement(l.a,{variant:"caption"},s.a.createElement(g.a,{defaultMessage:"Only owner can generate or update keys",id:"Shared.AppsAndKeys.TokenManager.key.and.user.owner"})))))),P&&!r.get(a)&&s.a.createElement(p.a,{className:e.paper},s.a.createElement(d.a,{defaultExpanded:!0},s.a.createElement(u.a,{expandIcon:s.a.createElement(y.a,null,"expand_more")},s.a.createElement(l.a,{className:e.heading,variant:"subtitle1"},s.a.createElement(g.a,{defaultMessage:"Provide Existing OAuth Keys",id:"Shared.AppsAndKeys.TokenManager.provide.oauth"}))),s.a.createElement(m.a,{className:e.keyConfigWrapper},s.a.createElement(C,{onChange:this.handleOnChangeProvidedOAuth,consumerKey:f,consumerSecret:b,isUserOwner:T}))),s.a.createElement("div",{className:e.generateWrapper},s.a.createElement(ce.a,{resourcePath:ce.c.APPLICATION_GENERATE_KEYS,resourceMethod:ce.b.POST},T?s.a.createElement(c.a,{variant:"contained",color:"primary",className:e.button,onClick:this.provideOAuthKeySecret},r.size>0&&r.get(a)?s.a.createElement(g.a,{defaultMessage:"Update",id:"Shared.AppsAndKeys.TokenManager. provide.oauth.button.update"}):s.a.createElement(g.a,{defaultMessage:"Provide",id:"Shared.AppsAndKeys. TokenManager.provide.oauth.button.provide"})):s.a.createElement(s.a.Fragment,null,s.a.createElement(c.a,{variant:"contained",color:"primary",className:e.button,onClick:this.provideOAuthKeySecret,disabled:!T},r.size>0&&r.get(a)?s.a.createElement(g.a,{defaultMessage:"Update",id:"Shared.AppsAndKeys.TokenManager.provide. oauth.button.update"}):s.a.createElement(g.a,{defaultMessage:"Provide",id:"Shared.AppsAndKeys.TokenManager. provide.oauth.button.provide"})),s.a.createElement(l.a,{variant:"caption"},s.a.createElement(g.a,{defaultMessage:"Only owner can provide keys",id:"Shared.AppsAndKeys.TokenManager.key.provide.user.owner"})))))))}}ye(ge,"contextType",K.c),ge.defaultProps={updateSubscriptionData:()=>{},summary:!1},ge.propTypes={classes:i.a.instanceOf(Object).isRequired,selectedApp:i.a.shape({tokenType:i.a.string.isRequired,appId:i.a.string,value:i.a.string,owner:i.a.string,hashEnabled:i.a.bool}).isRequired,keyType:i.a.string.isRequired,updateSubscriptionData:i.a.func,intl:i.a.shape({formatMessage:i.a.func}).isRequired,summary:i.a.bool};t.a=Object(g.e)(Object(o.a)(e=>({root:{padding:e.spacing(3),"& span, & h5, & label, & input":{color:e.palette.getContrastText(e.palette.background.paper)}},button:{marginLeft:0,"& span":{color:e.palette.getContrastText(e.palette.primary.main)}},cleanUpButton:{marginLeft:15},cleanUpInfoText:{padding:"10px 0px 10px 15px"},tokenSection:{marginTop:e.spacing(2),marginBottom:e.spacing(2)},margin:{marginRight:e.spacing(2)},keyConfigWrapper:{flexDirection:"column",marginBottom:0},generateWrapper:{padding:"10px 0px",marginLeft:e.spacing(1.25)},paper:{background:"none",marginBottom:e.spacing(2),marginTop:e.spacing(2)}}))(ge))}}]);
//# sourceMappingURL=APICredentials~ApplicationDetails.9ebf081f5aaaec7ef532.bundle.js.map